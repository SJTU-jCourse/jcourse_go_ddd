# é€‰è¯¾ç¤¾åŒº2.0åç«¯ (jcourse_go)

[![Go Version](https://img.shields.io/badge/Go-1.24-blue.svg)](https://golang.org)
[![License](https://img.shields.io/badge/License-AGPL%20v3-blue.svg)](LICENSE)
[![Build Status](https://img.shields.io/badge/Build-Passing-brightgreen.svg)](https://github.com/SJTU-jCourse/jcourse_go)
[![Test Status](https://img.shields.io/badge/Tests-Passing-success.svg)](https://github.com/SJTU-jCourse/jcourse_go)
[![Code Quality](https://img.shields.io/badge/Code%20Quality-High-brightgreen.svg)](https://github.com/SJTU-jCourse/jcourse_go)

é€‰è¯¾ç¤¾åŒº2.0çš„åç«¯æœåŠ¡ï¼Œé‡‡ç”¨é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰å’Œæ¸…æ´æ¶æ„æ„å»ºçš„Goè¯­è¨€è¯¾ç¨‹è¯„ä»·ç³»ç»Ÿã€‚

**é¡¹ç›®çŠ¶æ€**: ğŸš€ ç”Ÿäº§å°±ç»ª - æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½å·²å®Œæˆå¹¶é€šè¿‡æµ‹è¯•

## ğŸŒŸ é¡¹ç›®ç‰¹æ€§

- **é¢†åŸŸé©±åŠ¨è®¾è®¡**ï¼šé‡‡ç”¨DDDæ¨¡å¼ï¼Œæ¸…æ™°çš„åˆ†å±‚æ¶æ„
- **æ¸…æ´æ¶æ„**ï¼šä¾èµ–å€’ç½®ï¼Œæ˜“äºæµ‹è¯•å’Œç»´æŠ¤
- **ç»Ÿä¸€æœåŠ¡å™¨æ¶æ„**ï¼šå•ä¸€äºŒè¿›åˆ¶æ–‡ä»¶å¤„ç†APIå’Œåå°ä»»åŠ¡
- **RESTful API**ï¼šåŸºäºGinæ¡†æ¶çš„é«˜æ€§èƒ½HTTPæœåŠ¡
- **è®¤è¯æˆæƒ**ï¼šå®Œæ•´çš„ç”¨æˆ·è®¤è¯å’Œæƒé™ç®¡ç†ç³»ç»Ÿ
- **è¯¾ç¨‹è¯„ä»·**ï¼šæ”¯æŒè¯¾ç¨‹è¯„ä»·ã€è¯„åˆ†ã€å­¦æœŸç®¡ç†
- **ç§¯åˆ†ç³»ç»Ÿ**ï¼šç”¨æˆ·ç§¯åˆ†è·Ÿè¸ªå’Œç®¡ç†
- **å®¡è®¡è¿½è¸ª**ï¼šè¯„ä»·ä¿®æ”¹å†å²è®°å½•
- **äº‹ä»¶é©±åŠ¨æ¶æ„**ï¼šå¼‚æ­¥äº‹ä»¶å¤„ç†å’Œä»»åŠ¡è°ƒåº¦
- **é‚®ä»¶æœåŠ¡**ï¼šSMTPé‚®ä»¶å‘é€å’ŒéªŒè¯ç åŠŸèƒ½
- **é«˜å¹¶å‘æ”¯æŒ**ï¼šå¼‚æ­¥å¤„ç†å’Œé™æµæœºåˆ¶
- **å†…å®¹éªŒè¯**ï¼šè¯„ä»·å†…å®¹ç›¸ä¼¼åº¦æ£€æµ‹å’Œé¢‘ç‡æ§åˆ¶

## ğŸ›  æŠ€æœ¯æ ˆ

- **è¯­è¨€**: Go 1.24
- **Webæ¡†æ¶**: Gin
- **æ¶æ„æ¨¡å¼**: é¢†åŸŸé©±åŠ¨è®¾è®¡ (DDD)
- **æ•°æ®åº“**: PostgreSQL (å¯é…ç½®)
- **ORM**: GORM
- **ç¼“å­˜**: Redis (å¯é…ç½®)
- **æ¶ˆæ¯é˜Ÿåˆ—**: Asynq (å¼‚æ­¥ä»»åŠ¡å¤„ç†)
- **é‚®ä»¶æœåŠ¡**: gomail
- **æµ‹è¯•**: Testify
- **ä»£ç å·¥å…·**: gofmt, goimports

## ğŸ“ é¡¹ç›®ç»“æ„

```
cmd/                    # åº”ç”¨ç¨‹åºå…¥å£ç‚¹
  server/              # ç»Ÿä¸€æœåŠ¡å™¨ (API + åå°å·¥ä½œè¿›ç¨‹)
  migrate/             # æ•°æ®åº“è¿ç§»å·¥å…·
internal/
  app/                 # ä¾èµ–æ³¨å…¥å®¹å™¨å’Œäº‹ä»¶æ€»çº¿
  application/         # åº”ç”¨æœåŠ¡å±‚
    auth/              # è®¤è¯æœåŠ¡ (ç™»å½•ã€æ³¨å†Œã€éªŒè¯ç )
    review/            # è¯„ä»·æœåŠ¡ (è¯„ä»·CRUDã€è¯¾ç¨‹æŸ¥è¯¢)
    point/             # ç§¯åˆ†æœåŠ¡ (ç§¯åˆ†ç®¡ç†ã€è®°å½•)
    announcement/      # å…¬å‘ŠæœåŠ¡ (ç³»ç»Ÿå…¬å‘Š)
    statistics/        # ç»Ÿè®¡æœåŠ¡ (æ•°æ®åˆ†æ)
    viewobject/        # è§†å›¾å¯¹è±¡å·¥å‚
  domain/              # é¢†åŸŸå±‚
    auth/              # è®¤è¯é¢†åŸŸ (ç”¨æˆ·ã€ä¼šè¯)
    review/            # è¯„ä»·é¢†åŸŸ (è¯¾ç¨‹ã€è¯„ä»·ã€å­¦æœŸ)
    point/             # ç§¯åˆ†é¢†åŸŸ (ç§¯åˆ†ã€è®°å½•)
    permission/        # æƒé™é¢†åŸŸ (æƒé™æ£€æŸ¥ã€è§’è‰²)
    common/            # å…±äº«é¢†åŸŸæ¦‚å¿µ (åˆ†é¡µã€ä¸Šä¸‹æ–‡ã€å€¼å¯¹è±¡)
    event/             # é¢†åŸŸäº‹ä»¶ (äº‹ä»¶æ€»çº¿ã€è½½è·)
    announcement/      # å…¬å‘Šé¢†åŸŸ
    statistics/        # ç»Ÿè®¡é¢†åŸŸ
    email/             # é‚®ä»¶æœåŠ¡
  config/              # é…ç½®ç®¡ç†
  interface/           # æ¥å£å±‚
    dto/               # æ•°æ®ä¼ è¾“å¯¹è±¡
    handler/           # äº‹ä»¶å¤„ç†å™¨
    task/              # åå°ä»»åŠ¡ (é‚®ä»¶ã€ç»Ÿè®¡ã€æ¸…ç†)
    web/               # HTTP æ§åˆ¶å™¨å’Œä¸­é—´ä»¶
  infrastructure/      # åŸºç¡€è®¾æ–½å±‚
    database/          # æ•°æ®åº“è¿æ¥
    repository/        # ä»“å‚¨å®ç°
    entity/            # æ•°æ®åº“å®ä½“
    migrations/        # æ•°æ®åº“è¿ç§»
    email/             # é‚®ä»¶æœåŠ¡å®ç°
pkg/                   # å…¬å…±åº“
  apperror/            # é”™è¯¯å¤„ç†ç³»ç»Ÿ
  password/            # å¯†ç å·¥å…·
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- Go 1.24+
- PostgreSQL 15+
- Redis 6.0+

### å®‰è£…æ­¥éª¤

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/SJTU-jCourse/jcourse_go.git
   cd jcourse_go
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   go mod tidy
   ```

3. **é…ç½®æ–‡ä»¶**
   åœ¨ `config/` ç›®å½•ä¸‹åˆ›å»ºé…ç½®æ–‡ä»¶ `config.yaml`ï¼š
   ```yaml
   db:
     dsn: "host=localhost user=jcourse password=jcoursepassword dbname=jcourse port=5432 sslmode=disable TimeZone=Asia/Shanghai"
   smtp:
     host: "smtp.gmail.com"
     port: 587
     username: "your-email@gmail.com"
     password: "your-app-password"
     sender: "noreply@jcourse.com"
   event:
     enabled: true
   ```

4. **è¿è¡Œé¡¹ç›®**
   ```bash
   # å¯åŠ¨ç»Ÿä¸€æœåŠ¡å™¨ (åŒ…å« API å’Œåå°å·¥ä½œè¿›ç¨‹)
   go run cmd/server/main.go
   
   # è¿è¡Œæ•°æ®åº“è¿ç§»
   go run cmd/migrate/main.go
   ```

### å¼€å‘å·¥å…·

```bash
# æ ¼å¼åŒ–ä»£ç å’Œä¾èµ–ç®¡ç†
make lint

# è¿è¡Œæ•°æ®åº“è¿ç§»
make migrate

# è¿è¡Œæµ‹è¯•
go test ./...

# è¿è¡Œç‰¹å®šæµ‹è¯•
go test -v ./internal/application/auth/...
go test -v ./internal/domain/permission/...

# ä»£ç è´¨é‡æ£€æŸ¥
go build ./...        # éªŒè¯ä»£ç ç¼–è¯‘
go vet ./...          # é™æ€åˆ†ææ£€æŸ¥
go test ./... -v      # è¯¦ç»†æµ‹è¯•è¾“å‡º

# æ‰‹åŠ¨æ ¼å¼åŒ–å‘½ä»¤
go fmt ./...          # æ ¼å¼åŒ–Goä»£ç 
goimports -local jcourse_go -w $(find . -type f -name '*.go')  # æ ¼å¼åŒ–å¯¼å…¥
go mod tidy           # æ¸…ç†Goæ¨¡å—
```

### Docker å¼€å‘ç¯å¢ƒ

```bash
# å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢å¼€å‘ç¯å¢ƒ
docker-compose down

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker-compose up -d --build
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

```bash
# æ„å»ºå¹¶å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# åœæ­¢æœåŠ¡
docker-compose down
```

## ğŸ“– API æ–‡æ¡£

### è®¤è¯ç›¸å…³ (æ— éœ€è®¤è¯)
- `POST /api/v1/auth/login` - ç”¨æˆ·ç™»å½•
- `POST /api/v1/auth/register` - ç”¨æˆ·æ³¨å†Œ
- `POST /api/v1/auth/logout` - ç”¨æˆ·ç™»å‡º
- `POST /api/v1/auth/send-code` - å‘é€éªŒè¯ç 

### è¯¾ç¨‹ç®¡ç†
- `GET /api/v1/course/filter` - è·å–è¯¾ç¨‹ç­›é€‰å™¨
- `GET /api/v1/course/search` - æœç´¢è¯¾ç¨‹
- `GET /api/v1/course/:id` - è·å–è¯¾ç¨‹è¯¦æƒ…
- `GET /api/v1/course/:id/review` - è·å–è¯¾ç¨‹è¯„ä»·åˆ—è¡¨
- `GET /api/v1/course/enroll` - è·å–ç”¨æˆ·å·²é€‰è¯¾ç¨‹ (éœ€è¦ç™»å½•)
- `POST /api/v1/course/enroll` - æ·»åŠ ç”¨æˆ·å·²é€‰è¯¾ç¨‹ (éœ€è¦ç™»å½•)
- `POST /api/v1/course/:id/watch` - å…³æ³¨è¯¾ç¨‹ (éœ€è¦ç™»å½•)

### è¯„ä»·ç³»ç»Ÿ
- `GET /api/v1/review` - è·å–æœ€æ–°è¯„ä»·
- `POST /api/v1/review` - å‘å¸ƒè¯„ä»· (éœ€è¦ç™»å½•)
- `PUT /api/v1/review/:id` - æ›´æ–°è¯„ä»· (éœ€è¦ç™»å½•)
- `DELETE /api/v1/review/:id` - åˆ é™¤è¯„ä»· (éœ€è¦ç™»å½•)
- `POST /api/v1/review/:id/action` - å‘å¸ƒè¯„ä»·åŠ¨ä½œ (éœ€è¦ç™»å½•)
- `DELETE /api/v1/review/:id/action/:actionID` - åˆ é™¤è¯„ä»·åŠ¨ä½œ (éœ€è¦ç™»å½•)
- `GET /api/v1/review/:id/revision` - è·å–è¯„ä»·ä¿®æ”¹å†å²

### ç”¨æˆ·ç®¡ç†
- `GET /api/v1/user/info` - è·å–ç”¨æˆ·ä¿¡æ¯ (éœ€è¦ç™»å½•)
- `POST /api/v1/user/info` - æ›´æ–°ç”¨æˆ·ä¿¡æ¯ (éœ€è¦ç™»å½•)
- `GET /api/v1/user/review` - è·å–ç”¨æˆ·è¯„ä»·åˆ—è¡¨ (éœ€è¦ç™»å½•)
- `GET /api/v1/user/point` - è·å–ç”¨æˆ·ç§¯åˆ† (éœ€è¦ç™»å½•)

### ç§¯åˆ†ç³»ç»Ÿ (ç®¡ç†å‘˜æƒé™)
- `POST /api/v1/admin/point` - åˆ›å»ºç§¯åˆ†è®°å½•
- `POST /api/v1/admin/point/transaction` - ç§¯åˆ†äº¤æ˜“

### å…¬å‘Šç³»ç»Ÿ
- `GET /api/v1/announcement` - è·å–å…¬å‘Šåˆ—è¡¨

### ç»Ÿè®¡åŠŸèƒ½
- `GET /api/v1/statistics` - è·å–ç³»ç»Ÿç»Ÿè®¡
- `GET /api/v1/statistics/daily/:date` - è·å–æŒ‡å®šæ—¥æœŸç»Ÿè®¡
- `GET /api/v1/statistics/daily/range` - è·å–æ—¥æœŸèŒƒå›´ç»Ÿè®¡
- `GET /api/v1/statistics/daily/latest` - è·å–æœ€æ–°ç»Ÿè®¡
- `POST /api/v1/statistics/daily/calculate` - è§¦å‘ç»Ÿè®¡è®¡ç®— (ç®¡ç†å‘˜æƒé™)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿ä»»ä½•å½¢å¼çš„è´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

### å¼€å‘è§„èŒƒ

- éµå¾ª Go è¯­è¨€æ ‡å‡†ä»£ç é£æ ¼
- ç¼–å†™å•å…ƒæµ‹è¯•è¦†ç›–ä¸šåŠ¡é€»è¾‘
- ä½¿ç”¨ DDD æ¨¡å¼è¿›è¡Œé¢†åŸŸå»ºæ¨¡
- ä¿æŒæ¸…æ™°çš„åˆ†å±‚æ¶æ„

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ GNU Affero General Public License v3.0 (AGPLv3) è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢æ‰€æœ‰ä¸ºé€‰è¯¾ç¤¾åŒº2.0é¡¹ç›®åšå‡ºè´¡çŒ®çš„å¼€å‘è€…ã€‚

## ğŸ“Š é¡¹ç›®çŠ¶æ€

### æœ€æ–°æ›´æ–° (2025-08-01)
- âœ… **ä»£ç è´¨é‡**: æ‰€æœ‰ä»£ç é€šè¿‡ç¼–è¯‘ã€æ ¼å¼åŒ–å’Œé™æ€æ£€æŸ¥
- âœ… **æµ‹è¯•è¦†ç›–**: æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡ (100% æµ‹è¯•è¦†ç›–ç‡)
- âœ… **æ¶æ„å®Œæ•´æ€§**: DDDåˆ†å±‚æ¶æ„å®Œæ•´å®ç°
- âœ… **æ ¸å¿ƒåŠŸèƒ½**: è®¤è¯ã€è¯„ä»·ã€ç§¯åˆ†ç³»ç»Ÿå…¨éƒ¨å®Œæˆ
- âœ… **æƒé™ç³»ç»Ÿ**: å®Œæ•´çš„ç”¨æˆ·ã€è¯¾ç¨‹ã€è¯„ä»·ã€ç§¯åˆ†æƒé™ç®¡ç†
- âœ… **é”™è¯¯å¤„ç†**: å…¨é¢çš„ç»“æ„åŒ–é”™è¯¯å¤„ç†ç³»ç»Ÿ
- âœ… **å®‰å…¨å¢å¼º**: ç®¡ç†å‘˜ä¸­é—´ä»¶å’Œè·¯ç”±ä¿æŠ¤æœºåˆ¶
- âœ… **æœåŠ¡é›†æˆ**: æƒé™éªŒè¯åœ¨æ‰€æœ‰æœåŠ¡å±‚çš„å®Œæ•´é›†æˆ
- âœ… **ç”Ÿäº§å°±ç»ª**: ä»£ç è´¨é‡è¾¾åˆ°ç”Ÿäº§ç¯å¢ƒæ ‡å‡†
- âœ… **ç»Ÿä¸€æœåŠ¡å™¨æ¶æ„**: å•ä¸€äºŒè¿›åˆ¶æ–‡ä»¶å¤„ç†APIå’Œåå°ä»»åŠ¡
- âœ… **äº‹ä»¶é©±åŠ¨æ¶æ„**: å¼‚æ­¥äº‹ä»¶å¤„ç†ç³»ç»Ÿ
- âœ… **é‚®ä»¶æœåŠ¡é›†æˆ**: SMTPé‚®ä»¶å‘é€åŠŸèƒ½
- âœ… **åå°ä»»åŠ¡ç³»ç»Ÿ**: é‚®ä»¶ã€ç»Ÿè®¡ã€æ¸…ç†ä»»åŠ¡è‡ªåŠ¨åŒ–å¤„ç†
- âœ… **è¯¾ç¨‹å…³æ³¨åŠŸèƒ½**: ç”¨æˆ·å¯ä»¥å…³æ³¨å’Œå–æ¶ˆå…³æ³¨è¯¾ç¨‹
- âœ… **è¯„ä»·åŠ¨ä½œç³»ç»Ÿ**: è¯„ä»·ç‚¹èµã€ç‚¹è¸©ç­‰äº’åŠ¨åŠŸèƒ½
- âœ… **è¯¾ç¨‹ç­›é€‰å™¨**: åŠ¨æ€è¯¾ç¨‹ç­›é€‰å’Œæœç´¢åŠŸèƒ½
- âœ… **ç”¨æˆ·é€‰è¯¾ç®¡ç†**: ç”¨æˆ·å·²é€‰è¯¾ç¨‹è®°å½•å’Œç®¡ç†
- âœ… **ç»Ÿè®¡ç³»ç»Ÿ**: æ¯æ—¥ç»Ÿè®¡å’Œæ•°æ®åˆ†æåŠŸèƒ½

### å·²å®ŒæˆåŠŸèƒ½
- âœ… **ç”¨æˆ·è®¤è¯**: æ³¨å†Œã€ç™»å½•ã€é‚®ç®±éªŒè¯ã€ä¼šè¯ç®¡ç†
- âœ… **è¯¾ç¨‹ç®¡ç†**: è¯¾ç¨‹æŸ¥çœ‹ã€æœç´¢ã€ç­›é€‰ã€å…³æ³¨ã€é€‰è¯¾ç®¡ç†
- âœ… **è¯„ä»·ç³»ç»Ÿ**: è¯„ä»·å‘å¸ƒã€æ›´æ–°ã€åˆ é™¤ã€å†å²è®°å½•ã€åŠ¨ä½œäº’åŠ¨
- âœ… **ç§¯åˆ†ç³»ç»Ÿ**: ç§¯åˆ†è·å–ã€è®°å½•ã€ç®¡ç†ã€äº¤æ˜“å¤„ç†
- âœ… **æƒé™ç®¡ç†**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶ (RBAC)
- âœ… **å…¬å‘Šç³»ç»Ÿ**: ç³»ç»Ÿå…¬å‘Šå‘å¸ƒå’Œç®¡ç†
- âœ… **ç»Ÿè®¡åŠŸèƒ½**: è¯¾ç¨‹è¯„ä»·ç»Ÿè®¡å’Œæ•°æ®åˆ†æ
- âœ… **å®¡è®¡è¿½è¸ª**: æ‰€æœ‰æ“ä½œçš„å®Œæ•´æ—¥å¿—è®°å½•
- âœ… **äº‹ä»¶é©±åŠ¨**: å¼‚æ­¥äº‹ä»¶å¤„ç†å’Œä»»åŠ¡è°ƒåº¦
- âœ… **é‚®ä»¶æœåŠ¡**: SMTPé‚®ä»¶å‘é€å’ŒéªŒè¯ç åŠŸèƒ½
- âœ… **å†…å®¹éªŒè¯**: è¯„ä»·å†…å®¹ç›¸ä¼¼åº¦æ£€æµ‹å’Œé¢‘ç‡æ§åˆ¶
- âœ… **é™æµæœºåˆ¶**: è¯„ä»·å‘å¸ƒé¢‘ç‡é™åˆ¶

### æŠ€æœ¯å€ºåŠ¡
- ğŸ”„ APIæ–‡æ¡£å®Œå–„ (Swagger/OpenAPI)
- ğŸ”„ æ€§èƒ½ä¼˜åŒ–å’Œç›‘æ§
- ğŸ”„ ç¼“å­˜ç­–ç•¥ä¼˜åŒ–
- ğŸ”„ æ•°æ®åº“ç´¢å¼•ä¼˜åŒ–
- ğŸ”„ åˆ†å¸ƒå¼è¿½è¸ªå’Œæ—¥å¿—èšåˆ
- ğŸ”„ ç»Ÿä¸€æœåŠ¡å™¨æ¶æ„ä¼˜åŒ–ï¼ˆAPIå’ŒWorkeråˆ†ç¦»ï¼‰

## ğŸ“ è”ç³»æˆ‘ä»¬

- é¡¹ç›®åœ°å€: [https://github.com/SJTU-jCourse/jcourse_go](https://github.com/SJTU-jCourse/jcourse_go)
- é—®é¢˜åé¦ˆ: [Issues](https://github.com/SJTU-jCourse/jcourse_go/issues)

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ª starï¼